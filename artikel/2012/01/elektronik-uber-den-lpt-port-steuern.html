<!DOCTYPE html>
<html lang="de">
  <head>
    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="keywords" content="Johannes Mittendorfer, Mittendorfer, Blog, Informatik, Student, Entwicklung, Security">
    <meta name="description" content="Der Blog von Informatik-Student Johannes Mittendorfer über das Leben im Studium, Software-Entwicklung, IT-Security und das Internet">
    <meta name="author" content="Johannes Mittendorfer">
    <meta http-equiv="cleartype" content="on">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <meta name="application-name" content="Johannes Mittendorfer"/>
    <meta name="msapplication-TileColor" content="#f9fbf4"/>
    <meta http-equiv="imagetoolbar" content="false" />
    <meta property="fb:admins" content="100000063853580" />
    <meta name="Content-Language" content="de" />
    <!-- resources -->
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
    <link rel="canoncial" href="https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern">
    <!-- styles -->
    <link rel="stylesheet" href="/assets/css/styles.css"/>
    <!-- title -->
    <title>Elektronik über den LPT-Port steuern</title>
    <!-- page specific resources -->
  </head>
  <body itemscope itemtype="http://schema.org/WebSite">
    <!-- menu bar -->
    <nav id="bar">
      <section class="container">
        <a class="title" itemprop="url" href="/">
          <h1 itemprop="name">Johannes Mittendorfer</h1>
        </a>
        <ul>
          <li>
            <a href="/">
              Start
            </a>
          </li>
          <li>
            <a itemprop="about" href="/ueber-mich" title="Über">
              Über
            </a>
          </li>
          <li>
            <a href="/astronomie" title="Astronomie">
              Astronomie
            </a>
          </li>
          <li>
            <a href="/impressum" title="Impressum">
              Impressum
            </a>
          </li>
        </ul>
      </section>
    </nav>
    <!-- main content -->
    <div class="container">
      <main>
        <!-- semantic description -->
        <script type="application/ld+json">
          {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "@id": "https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern",
            "headline": "Elektronik über den LPT-Port steuern",
            "description": "",
            "datePublished": "2012-01-05 00:00:00 +0100",
            "dateModified": "2012-01-05 00:00:00 +0100",
            "author": {
              "@type": "Person",
              "name": "Johannes Mittendorfer"
            },
            "publisher": {
              "@type": "Organization",
              "name": "Johannes Mittendorfer",
              "logo": {
                  "@type": "ImageObject",
                  "url": "https://blog.johannes-mittendorfer.com/assets/favicon.ico",
                  "width": 16,
                  "height": 16
              }
            },
          
            "mainEntityOfPage": {
              "@id": "https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern"
            }
          }
        </script>
        <script type="application/ld+json">
          {
            "@context": "http://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [{
              "@type": "ListItem",
              "position": 1,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel",
                "name": "Artikel"
              }
            },
            {
              "@type": "ListItem",
              "position": 2,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2012",
                "name": "2012"
              }
            },
            {
              "@type": "ListItem",
              "position": 3,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2012/01",
                "name": "01"
              }
            },
            {
              "@type": "ListItem",
              "position": 4,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern",
                "name": "Elektronik über den LPT-Port steuern"
              }
            }]
          }
        </script>
        <article itemscope itemtype="http://schema.org/BlogPosting">
          <header>
            <div class="meta">
              <span class="category">Entwicklung</span> &ndash; 
              <time itemprop="datePublished" datetime="2012-01-05T00:00:00+01:00" class="date">05.01.2012</time> &ndash;
              <a itemprop="author" href="https://blog.johannes-mittendorfer.com/ueber-mich">Johannes Mittendorfer</a>
            </div>
            <h1 itemprop="headline">Elektronik über den LPT-Port steuern</h1>
            <div class="warning">
              Dieser Artikel ist älter als zwei Jahre und womöglich veraltet!
            </div>
          </header>
          <div itemprop="articleBody">
            <p>Öfters möchte man einen kleinen oder auch größeren Schaltkreis über den PC steuern, wäre da nicht die komplizierte Umsetzung mit einem geeigneten Mikrocontroller und der benötigten Software.</p>
            <p>Doch es geht viel einfacher: Der parellele Port, auch LPT-Port genannt, steht auf den meisten PC zur Verfügung und kann Kinderleicht dazu verwendet werden verschiedenen Pins einzeln mit Spannung zu versorgen.</p>
            <h2 id="hardware">Hardware</h2>
            <p><img src="/assets/img/picture_73.png" alt="Port des parallelen Anschlusses" /></p>
            <p>Dieser Anschluss, der vormals DER Standard für den Anschluss eines Druckers war, lässt sich für die Steuerung eines Schaltkreises verwenden indem man einen Draht in einen der Pins 2-9 und einen Draht in einen Pin von 18 bis 25 steckt.</p>
            <p>Die Pins 2 bis 9 können einzeln vom PC mit Spannung geschaltet werden und stellen eine (Steuer-)Spannung von ca. 5 V bereit. Diese Spannung <strike>kann</strike> sollte mit einem Transistor verwendet werden, um über einen Steuerstromkreis den Arbeitsstromkreis mit (nahezu) beliebiger Spannung zu betreiben.</p>
            <p>Außerdem kann über die Pins 10-13 ein Signal enpfangen werden, was in diesem Fall bedeutet, dass der Stromkreis geschlossen ist und Strom von den Pins 18-25 zu den Pins 10-13 fließt.</p>
            <p>Ein LPT-Kabel, das in meinem Fall einen alten Drucker mit Daten versorgte, verlegt den Anschluss bequem nach vorne und erspart einem so manchen Schlag mit dem Kopf gegen die Tischplatte.</p>
            <h2 id="software">Software</h2>
            <p>Beispiel eines TCP-Clients zum Steuern einer LED:</p>
            <p><img src="/assets/img/picture_74.png" alt="Beispiel GUI" /></p>
            <p>Für das einfache Anlegen einer Spannung auf einem Pin empfehle ich das Programme lptout.exe. Für komplexere Aufgaben ist jedoch die Klasse inpout32.dll bzw. inpout64.dll geeignet. Da ich keine Rechte für die genannten Programme besitze, möchte ich nicht auf einen Download verlinken, doch eine Google-Suche bringt einem schnell ans Ziel.</p>
            <p>Ich habe mir für leichtere Handhabung eine kleine C#-Klasse geschrieben:</p>
            <figure class="highlight">
              <pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">WindowsFormsApplication1</span><span class="p">{</span>

	<span class="k">public</span> <span class="k">class</span> <span class="nc">LPTController</span><span class="p">{</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="n">UInt32</span> <span class="nf">IsInpOutDriverOpen</span><span class="p">();</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="k">void</span> <span class="nf">Out32</span><span class="p">(</span><span class="kt">short</span> <span class="n">PortAddress</span><span class="p">,</span> <span class="kt">short</span> <span class="n">Data</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">char</span> <span class="nf">Inp32</span><span class="p">(</span><span class="kt">short</span> <span class="n">PortAddress</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="k">void</span> <span class="nf">DlPortWritePortUshort</span><span class="p">(</span><span class="kt">short</span> <span class="n">PortAddress</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">Data</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">ushort</span> <span class="nf">DlPortReadPortUshort</span><span class="p">(</span><span class="kt">short</span> <span class="n">PortAddress</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="k">void</span> <span class="nf">DlPortWritePortUlong</span><span class="p">(</span><span class="kt">int</span> <span class="n">PortAddress</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">Data</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpout32.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">uint</span> <span class="nf">DlPortReadPortUlong</span><span class="p">(</span><span class="kt">int</span> <span class="n">PortAddress</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpoutx64.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">bool</span> <span class="nf">GetPhysLong</span><span class="p">(</span><span class="k">ref</span> <span class="kt">int</span> <span class="n">PortAddress</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">uint</span> <span class="n">Data</span><span class="p">);</span>

		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"inpoutx64.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">bool</span> <span class="nf">SetPhysLong</span><span class="p">(</span><span class="k">ref</span> <span class="kt">int</span> <span class="n">PortAddress</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">uint</span> <span class="n">Data</span><span class="p">);</span>

		<span class="k">private</span> <span class="kt">bool</span> <span class="n">_X64</span><span class="p">;</span>
		<span class="k">private</span> <span class="kt">short</span> <span class="n">_PortAddress</span><span class="p">;</span>

		<span class="k">public</span> <span class="nf">LPTController</span><span class="p">(</span><span class="kt">short</span> <span class="n">PortAddress</span><span class="p">){</span>
			<span class="n">_X64</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
			<span class="n">_PortAddress</span> <span class="p">=</span> <span class="n">PortAddress</span><span class="p">;</span>
		
			<span class="k">try</span><span class="p">{</span>
				<span class="kt">uint</span> <span class="n">nResult</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
				<span class="k">try</span><span class="p">{</span>
					<span class="n">nResult</span> <span class="p">=</span> <span class="nf">IsInpOutDriverOpen</span><span class="p">();</span>
				<span class="p">}</span>
				<span class="k">catch</span> <span class="p">(</span><span class="n">BadImageFormatException</span><span class="p">){</span>

				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">nResult</span> <span class="p">==</span> <span class="m">0</span><span class="p">){</span>
					<span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Unable to open InpOut32 driver"</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">catch</span> <span class="p">(</span><span class="n">DllNotFoundException</span><span class="p">){</span>
				<span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Unable to find InpOut32.dll"</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		
		<span class="k">public</span> <span class="k">void</span> <span class="nf">Write</span><span class="p">(</span><span class="kt">short</span> <span class="n">Data</span><span class="p">){</span>
			<span class="nf">Out32</span><span class="p">(</span><span class="n">_PortAddress</span><span class="p">,</span> <span class="n">Data</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="k">public</span> <span class="kt">byte</span> <span class="nf">Read</span><span class="p">(){</span>
			<span class="k">return</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="nf">Inp32</span><span class="p">(</span><span class="n">_PortAddress</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre>
            </figure>
            <p>Mit dieser Klasse kann man einfach den Zustand Auslesen und ihn ändern:</p>
            <figure class="highlight">
              <pre><code class="language-csharp" data-lang="csharp"><span class="n">LPTController</span> <span class="n">lpt</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">LPTController</span><span class="p">(</span><span class="m">888</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="n">lpt</span><span class="p">.</span><span class="nf">Read</span><span class="p">()</span> <span class="p">==</span> <span class="m">255</span><span class="p">){</span>
	<span class="n">lpt</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">{</span>
	<span class="n">lpt</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="m">255</span><span class="p">);</span>
<span class="p">}</span></code></pre>
            </figure>
            <h2 id="hinweis">Hinweis</h2>
            <p>Natürlich geschieht das alles auf Ihre eigene Gefahr und ich übernehme keine Haftung für jedwede Schäden an Gerät und Gesundheit. 230V haben hier nichts verloren!!!</p>
            <p>Update 13.03.2016: Natürlich muss es der parallele und nicht der serielle Port.</p>
          </div>
          <footer>
            <div id="share">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern" class="share-icon facebook"><i class="fa fa-facebook"></i> Facebook</a>
              <a href="https://twitter.com/intent/tweet?original_referer=https://johannes-mittendorfer.com&source=tweetbuttont&url=https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern" class="share-icon twitter"><i class="fa fa-twitter"></i> Twitter</a>
              <a href="https://plus.google.com/share?url=https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern&hl=de" class="share-icon googleplus"><i class="fa fa-google-plus"></i> Google+</a>
              <a href="https://flattr.com/submit/auto?user_id=joushx&url=https://blog.johannes-mittendorfer.com/artikel/2012/01/elektronik-uber-den-lpt-port-steuern&title=Elektronik%20%C3%BCber%20den%20LPT-Port%20steuern" class="share-icon flattr">Flattr</a>
            </div>
          </footer>
        </article>
      </main>
    </div>
  </body>
</html>